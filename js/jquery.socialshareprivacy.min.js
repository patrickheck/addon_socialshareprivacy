/*
 * jquery.socialshareprivacy.js | 2 Klicks fuer mehr Datenschutz
 *
 * http://www.heise.de/extras/socialshareprivacy/
 * http://www.heise.de/ct/artikel/2-Klicks-fuer-mehr-Datenschutz-1333879.html
 *
 * Copyright (c) 2011 Hilko Holweg, Sebastian Hilbig, Nicolas Heiringhoff, Juergen Schmidt
 * Heise Zeitschriften Verlag GmbH & Co. KG, http://www.heise.de,
 *
 * Copyright (c) 2011 Tilmann Kuhn
 * object-zoo, http://www.object-zoo.net
 *
 * is released under the MIT License http://www.opensource.org/licenses/mit-license.php
 *
 * Spread the word, link to us if you can.
 */
(function(c){function s(b){return c('meta[name="'+b+'"]').attr("content")||""}function t(){var b=s("DC.title"),a=s("DC.creator"),b=0<b.length&&0<a.length?b+(" - "+a):c("title").text();return encodeURIComponent(b)}function u(){var b=document.location.href,a=c("link[rel=canonical]").attr("href");a&&0<a.length&&(0>a.indexOf("http")&&(a=document.location.protocol+"//"+document.location.host+a),b=a);return b}c.fn.socialSharePrivacy=function(b){var a=c.extend(!0,{services:{facebook:{status:"on",dummy_img:"",
txt_info:"2 Klicks f&uuml;r mehr Datenschutz: Erst wenn Sie hier klicken, wird der Button aktiv und Sie k&ouml;nnen Ihre Empfehlung an Facebook senden. Schon beim Aktivieren werden Daten an Dritte &uuml;bertragen &ndash; siehe <em>i</em>.",txt_fb_off:"nicht mit Facebook verbunden",txt_fb_on:"mit Facebook verbunden",perma_option:"on",display_name:"Facebook",referrer_track:"",language:"de_DE",action:"recommend",dummy_caption:"Empfehlen"},twitter:{status:"on",dummy_img:"",txt_info:"2 Klicks f&uuml;r mehr Datenschutz: Erst wenn Sie hier klicken, wird der Button aktiv und Sie k&ouml;nnen Ihre Empfehlung an Twitter senden. Schon beim Aktivieren werden Daten an Dritte &uuml;bertragen &ndash; siehe <em>i</em>.",
txt_twitter_off:"nicht mit Twitter verbunden",txt_twitter_on:"mit Twitter verbunden",perma_option:"on",display_name:"Twitter",referrer_track:"",tweet_text:t,language:"en",dummy_caption:"Tweet"},gplus:{status:"on",dummy_img:"",txt_info:"2 Klicks f&uuml;r mehr Datenschutz: Erst wenn Sie hier klicken, wird der Button aktiv und Sie k&ouml;nnen Ihre Empfehlung an Google+ senden. Schon beim Aktivieren werden Daten an Dritte &uuml;bertragen &ndash; siehe <em>i</em>.",txt_gplus_off:"nicht mit Google+ verbunden",
txt_gplus_on:"mit Google+ verbunden",perma_option:"on",display_name:"Google+",referrer_track:"",language:"de"}},info_link:"http://www.heise.de/ct/artikel/2-Klicks-fuer-mehr-Datenschutz-1333879.html",txt_help:"Wenn Sie diese Felder durch einen Klick aktivieren, werden Informationen an Facebook, Twitter oder Google in die USA &uuml;bertragen und unter Umst&auml;nden auch dort gespeichert. N&auml;heres erfahren Sie durch einen Klick auf das <em>i</em>.",settings_perma:"Dauerhaft aktivieren und Daten&uuml;ber&shy;tragung zustimmen:",
cookie_path:"/",cookie_domain:document.location.host,cookie_expires:"365",css_path:"socialshareprivacy/socialshareprivacy.css",uri:u},b),n="on"===a.services.facebook.status,p="on"===a.services.twitter.status,q="on"===a.services.gplus.status;if(n||p||q)return 0<a.css_path.length&&(document.createStyleSheet?document.createStyleSheet(a.css_path):c("head").append('<link rel="stylesheet" type="text/css" href="'+a.css_path+'" />')),this.each(function(){c(this).prepend('<ul class="social_share_privacy_area"></ul>');
var e=c(".social_share_privacy_area",this),b=a.uri;"function"===typeof b&&(b=b(e));if(n){var d=encodeURIComponent(b+a.services.facebook.referrer_track),s='<iframe src="http://www.facebook.com/plugins/like.php?locale='+a.services.facebook.language+"&amp;href="+d+"&amp;send=false&amp;layout=button_count&amp;width=120&amp;show_faces=false&amp;action="+a.services.facebook.action+'&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:145px; height:21px;" allowTransparency="true"></iframe>',
v;v=a.services.facebook.dummy_img?'<img class="fb_like_privacy_dummy" src="'+a.services.facebook.dummy_img+'" alt="'+a.services.facebook.dummy_caption+'" />':'<div class="fb_like_privacy_dummy"><span>'+a.services.facebook.dummy_caption+"</span></div>";e.append('<li class="facebook help_info"><span class="info">'+a.services.facebook.txt_info+'</span><span class="switch off">'+a.services.facebook.txt_fb_off+'</span><div class="fb_like dummy_btn">'+v+"</div></li>");var k=c("li.facebook",e);e.on("click",
"li.facebook div.fb_like .fb_like_privacy_dummy,li.facebook span.switch",function(){k.find("span.switch").hasClass("off")?(k.addClass("info_off"),k.find("span.switch").addClass("on").removeClass("off").html(a.services.facebook.txt_fb_on),k.find(".fb_like_privacy_dummy").replaceWith(s)):(k.removeClass("info_off"),k.find("span.switch").addClass("off").removeClass("on").html(a.services.facebook.txt_fb_off),k.find(".fb_like").html(v))})}if(p){d=a.services.twitter.tweet_text;"function"===typeof d&&(d=
d());var g=d,d=decodeURIComponent(g);"120">=d.length?d=g:(g=d.substring(0,119).lastIndexOf(" "),d=encodeURIComponent(d.substring(0,g))+"\u2026");var g=encodeURIComponent(b+a.services.twitter.referrer_track),f=encodeURIComponent(b),t='<iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url='+g+"&amp;counturl="+f+"&amp;text="+d+"&amp;count=horizontal&amp;lang="+a.services.twitter.language+'" style="width:130px; height:25px;"></iframe>',
w;w=a.services.twitter.dummy_img?'<img class="tweet_this_dummy" src="'+a.services.twitter.dummy_img+'" alt="'+a.services.twitter.dummy_caption+'" />':'<div class="tweet_this_dummy"><span>'+a.services.twitter.dummy_caption+"</span></div>";e.append('<li class="twitter help_info"><span class="info">'+a.services.twitter.txt_info+'</span><span class="switch off">'+a.services.twitter.txt_twitter_off+'</span><div class="tweet dummy_btn">'+w+"</div></li>");var l=c("li.twitter",e);e.on("click","li.twitter .tweet_this_dummy,li.twitter span.switch",
function(){l.find("span.switch").hasClass("off")?(l.addClass("info_off"),l.find("span.switch").addClass("on").removeClass("off").html(a.services.twitter.txt_twitter_on),l.find(".tweet_this_dummy").replaceWith(t)):(l.removeClass("info_off"),l.find("span.switch").addClass("off").removeClass("on").html(a.services.twitter.txt_twitter_off),l.find(".tweet").html(w))})}if(q){var u='<div class="g-plusone" data-size="medium" data-href="'+(b+a.services.gplus.referrer_track)+'"></div><script type="text/javascript">window.___gcfg = {lang: "'+
a.services.gplus.language+'"}; (function() { var po = document.createElement("script"); po.type = "text/javascript"; po.async = true; po.src = "https://apis.google.com/js/plusone.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(po, s); })(); \x3c/script>',x;x=a.services.gplus.dummy_img?'<img src="'+a.services.gplus.dummy_img+'" alt="+1" class="gplus_one_dummy" />':'<div class="gplus_one_dummy">+1</div>';e.append('<li class="gplus help_info"><span class="info">'+a.services.gplus.txt_info+
'</span><span class="switch off">'+a.services.gplus.txt_gplus_off+'</span><div class="gplusone dummy_btn">'+x+"</div></li>");var m=c("li.gplus",e);e.on("click","li.gplus div.gplusone .gplus_one_dummy,li.gplus span.switch",function(){m.find("span.switch").hasClass("off")?(m.addClass("info_off"),m.find("span.switch").addClass("on").removeClass("off").html(a.services.gplus.txt_gplus_on),m.find(".gplus_one_dummy").replaceWith(u)):(m.removeClass("info_off"),m.find("span.switch").addClass("off").removeClass("on").html(a.services.gplus.txt_gplus_off),
m.find(".gplusone").html(x))})}e.append('<li class="settings_info"><div class="settings_info_menu off perma_option_off"><a href="'+a.info_link+'"><span class="help_info icon"><span class="info">'+a.txt_help+"</span></span></a></div></li>");e.on("mouseenter",".help_info:not(.info_off)",function(){var a=c(this),b=window.setTimeout(function(){c(a).addClass("display")},500);c(this).data("timeout_id",b)});e.on("mouseleave",".help_info",function(){var a=c(this).data("timeout_id");window.clearTimeout(a);
c(this).hasClass("display")&&c(this).removeClass("display")});b="on"===a.services.facebook.perma_option;d="on"===a.services.twitter.perma_option;g="on"===a.services.gplus.perma_option;if((n&&b||p&&d||q&&g)&&JSON&&JSON.parse){for(var j=document.cookie.split(";"),f="{",r=0;r<j.length;r+=1){var y=j[r].split("="),f=f+('"'+c.trim(y[0])+'":"'+c.trim(y[1])+'"');r<j.length-1&&(f+=",")}var f=JSON.parse(f+"}"),h=c("li.settings_info",e);h.find(".settings_info_menu").removeClass("perma_option_off");h.find(".settings_info_menu").append('<span class="settings">Einstellungen</span><form><fieldset><legend>'+
a.settings_perma+"</legend></fieldset></form>");n&&b&&(j="perma_on"===f.socialSharePrivacy_facebook?' checked="checked"':"",h.find("form fieldset").append('<input type="checkbox" name="perma_status_facebook" id="perma_status_facebook"'+j+' /><label for="perma_status_facebook">'+a.services.facebook.display_name+"</label>"));p&&d&&(j="perma_on"===f.socialSharePrivacy_twitter?' checked="checked"':"",h.find("form fieldset").append('<input type="checkbox" name="perma_status_twitter" id="perma_status_twitter"'+
j+' /><label for="perma_status_twitter">'+a.services.twitter.display_name+"</label>"));q&&g&&(j="perma_on"===f.socialSharePrivacy_gplus?' checked="checked"':"",h.find("form fieldset").append('<input type="checkbox" name="perma_status_gplus" id="perma_status_gplus"'+j+' /><label for="perma_status_gplus">'+a.services.gplus.display_name+"</label>"));h.find("span.settings").css("cursor","pointer");h.on("mouseenter","span.settings",function(){var a=window.setTimeout(function(){h.find(".settings_info_menu").removeClass("off").addClass("on")},
500);c(this).data("timeout_id",a)});h.on("mouseleave",function(){var a=c(this).data("timeout_id");window.clearTimeout(a);h.find(".settings_info_menu").removeClass("on").addClass("off")});h.on("click","fieldset input",function(b){var d=b.target.id,f="socialSharePrivacy_"+d.substr(d.lastIndexOf("_")+1,d.length);if(c("#"+b.target.id+":checked").length){b=a.cookie_expires;var h=a.cookie_path,g=a.cookie_domain,j=new Date;j.setTime(j.getTime()+864E5*b);document.cookie=f+"=perma_on; expires="+j.toUTCString()+
"; path="+h+"; domain="+g;c("form fieldset label[for="+d+"]",e).addClass("checked")}else b=a.cookie_path,h=a.cookie_domain,g=new Date,g.setTime(g.getTime()-100),document.cookie=f+"=perma_on; expires="+g.toUTCString()+"; path="+b+"; domain="+h,c("form fieldset label[for="+d+"]",e).removeClass("checked")});n&&(b&&"perma_on"===f.socialSharePrivacy_facebook)&&c("li.facebook span.switch",e).click();p&&(d&&"perma_on"===f.socialSharePrivacy_twitter)&&c("li.twitter span.switch",e).click();q&&(g&&"perma_on"===
f.socialSharePrivacy_gplus)&&c("li.gplus span.switch",e).click()}})}})(jQuery);